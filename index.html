<!DOCTYPE html>
<html>
<head>
  <title>Inventory Manager</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container py-5">
  <h2 class="mb-4">Inventory Management</h2>

  <form id="itemForm" class="row g-3 mb-5">
    <input class="form-control" placeholder="Asset ID" id="assetId" required>
    <input class="form-control" placeholder="Item Description" id="description" required>
    <input class="form-control" placeholder="Category" id="category">
    <input class="form-control" placeholder="Serial Number" id="serial">
    <input class="form-control" placeholder="Assigned To" id="assignedTo">
    <input class="form-control" placeholder="Department" id="department">
    <input class="form-control" type="date" placeholder="Date Acquired" id="acquired">
    <input class="form-control" type="date" placeholder="Warranty Expiry" id="expiry">
    <select class="form-select" id="status">
      <option>Active</option>
      <option>In Repair</option>
      <option>Disposed</option>
    </select>
    <input class="form-control" placeholder="Remarks" id="remarks">
    <button class="btn btn-primary mt-3" type="submit">Add Item</button>
  </form>

  <h4>Inventory List</h4>
  <ul id="inventoryList" class="list-group"></ul>

  <script>
    const apiUrl = 'https://script.google.com/macros/s/AKfycbx32FktX67eD-DC8yBfqPI-STwFVNiZT8RycBPPDqfeLrEGXlDJVnvNE-RW5cTCePw/exec'; // Replace with your deployed script URL

    document.getElementById("itemForm").addEventListener("submit", function(e) {
      e.preventDefault();

      const data = {
        "Asset ID": document.getElementById("assetId").value,
        "Item Description": document.getElementById("description").value,
        "Category": document.getElementById("category").value,
        "Serial Number": document.getElementById("serial").value,
        "Assigned To": document.getElementById("assignedTo").value,
        "Department": document.getElementById("department").value,
        "Date Acquired": document.getElementById("acquired").value,
        "Warranty Expiry": document.getElementById("expiry").value,
        "Status": document.getElementById("status").value,
        "Remarks": document.getElementById("remarks").value
      };

      fetch(apiUrl, {
        method: "POST",
        body: JSON.stringify(data),
        headers: { "Content-Type": "application/json" }
      })
      .then(res => res.text())
      .then(() => {
        alert("Item Added!");
        loadInventory();
      });
    });

    function loadInventory() {
      fetch(apiUrl)
        .then(res => res.json())
        .then(data => {
          let html = "";
          data.forEach(item => {
            html += `<li class="list-group-item">${item["Asset ID"]} - ${item["Item Description"]} - ${item["Status"]}</li>`;
          });
          document.getElementById("inventoryList").innerHTML = html;
        });
    }

    loadInventory();
  </script>
</body>
</html>
